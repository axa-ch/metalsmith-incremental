<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [metalsmithIncremental](#metalsmithincremental)
-   [filter](#filter)
-   [cache](#cache)
-   [watch](#watch)
-   [PathsObject](#pathsobject)
-   [DependencyResolver](#dependencyresolver)
-   [IncrementalDoneFn](#incrementaldonefn)
-   [RenameFunction](#renamefunction)
-   [DependencyResolverMap](#dependencyresolvermap)
-   [RenameObject](#renameobject)
-   [PathObject](#pathobject)
-   [PropsList](#propslist)

## metalsmithIncremental

Returns the selected `metalsmith-incremental` subplugin.
Use:

-   `filter`: to remove unmodified files from the pipeline
-   `cache`: to cache current state in the pipeline and to restore filtered files by `filter`
-   `watch`: to start watching for file changes (can be used only once)

**Parameters**

-   `options` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)?** Plugin options hash.
    -   `options.plugin` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** Specify the sub plugin to use - `filter`, `cache` or `watch`. (optional, default `filter`)
    -   `options.baseDir` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)?** The baseDir to which to resolve absolute paths in dependencies (`filter` only).
    -   `options.depResolver` **([RegExp](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp) \| [DependencyResolver](#dependencyresolver) \| [DependencyResolverMap](#dependencyresolvermap))?** A RegExp pattern or callback to resolve dependencies (`filter` only).
    -   `options.rename` **([RenameObject](#renameobject) \| [RenameFunction](#renamefunction))?** A function or object defining renaming rules (`cache` only).
    -   `options.props` **[PropsList](#propslist)?** An array of property names to sync from cached files to new files (`cache` only). (optional, default `['contents']`)
    -   `options.paths` **([PathsObject](#pathsobject) \| [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String))?** A glob-pattern map which forces updates of mapped files (`watch` only).
    -   `options.delay` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)?** The number of milliseconds the rebuild is delayed to wait for additional changes (`watch` only). (optional, default `100`)
    -   `options.done` **[IncrementalDoneFn](#incrementaldonefn)?** A callback to call after incremental build has finished (same signature as `fn` in `metalsmith.build(fn)` (`watch` only).

Returns **([filter](#filter) \| [cache](#cache) \| [watch](#watch))** Returns the specified metalsmith sub plugin - `filter`, `cache` or `watch`.

## filter

Removes unmodified files from the pipeline by resolving:

-   changed, added, removed files or directories
-   resolving glob map matches
-   infer dependencies

**Options**

-   `baseDir`
-   `depResolver`

**Parameters**

-   `files` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
-   `metalsmith` **MetalSmith** 
-   `done` **[Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

**Examples**

```javascript
metalsmith.usw(incremental({
 plugin: 'filter', // default 'filter' -> can be omitted
 baseDir: 'your/base/dir',
}))
```

_Resolving Dependencies by RegExp_

```javascript
metalsmith.usw(incremental({
 baseDir: 'your/base/dir',
 // important the first capturing group must contain the dependency path
 depResolver: /(?:include|extends)\s+([^\s]+)/mg,
}))
```

_Resolving Dependencies by Hash-Map_

```javascript
metalsmith.usw(incremental({
 baseDir: 'your/base/dir',
 depResolver: {
   pug: /(?:include|extends)\s+([^\s]+)/mg,
 },
}))
```

_Resolving Dependencies by Function_

```javascript
metalsmith.usw(incremental({
 baseDir: 'your/base/dir',
 depResolver: (file, baseDir) {
   // read file contents
   const contents = file.contents
   const dependencies = []

   // ... your custom dependencies resolve algorith here

   return dependencies
 },
}))
```

## cache

Caches all files at the specific point in the pipeline and
restores unmodified files filtered previously by `filter`.

**Options**

-   `rename`
-   `props`

**Parameters**

-   `files` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
-   `metalsmith` **MetalSmith** 
-   `done` **[Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

**Examples**

```javascript
metalsmith.use(increment({
 plugin: 'cache',
})
```

_Renaming files by RegExp_

```javascript
metalsmith.use(increment({
 plugin: 'cache',
 rename: {
   from: /.pug$/,
   to: '.html',
 },
})
```

_Renaming files by function_

```javascript
metalsmith.use(increment({
 plugin: 'cache',
 rename: (path) => {
   path.extname = path.extname.replace('.pug', '.html')

   return path
 },
})
```

## watch

Starts watching for file system changes inside `metalsmith.source()` directory.

**Options**

-   `paths`
-   `delay`
-   `done`

**Parameters**

-   `files` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
-   `metalsmith` **MetalSmith** 
-   `done` **[Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)** 

**Examples**

```javascript
// optionally enable watching
if(process.env.NODE_ENV === 'development') {
 metalsmith.use(incremental({ plugin: 'watch' }))
}
```

_Set debounce delay in [ms]_

```javascript
metalsmith.use(incremental({
 plugin: 'watch',
 debounce: 200,
}))
```

_Force to rebuild other unmodified files by glob pattern map_

```javascript
metalsmith.use(incremental({
 plugin: 'watch',
 paths: {
   'foo/*.md': 'bar/*.pug',
 },
}))
```

## PathsObject

Paths pattern map to force rebuilding unmodified files.

```js
{
  'file(s) to watch': 'file(s) to rebuild'
}
```

```js
{
  'templates/*': '*', // every templates changed will trigger a rebuild of all files
}
```

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

## DependencyResolver

A callback which defines renaming rules.

Type: [Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)

**Parameters**

-   `file` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** The currently processed file.
-   `baseDir` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The supplied `baseDir` by `options.baseDir`.

Returns **([Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array) | null)** dependencies - Returns an array of dependencies (relative to `baseDir`).

## IncrementalDoneFn

A callback to call after incremental build has finished (same signature as `fn` in `metalsmith.build(fn)`.

Type: [Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)

**Parameters**

-   `error` **(null | any)** Set only if an error has occurred.
-   `files` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** A hash of files build by Metalsmith.

## RenameFunction

A callback which defines renaming rules.

Type: [Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function)

**Parameters**

-   `path` **[PathObject](#pathobject)** The current path of the file.

Returns **[PathObject](#pathobject)** path - The new path to be used.

## DependencyResolverMap

An object mapping file extension to related dependency resolving methods.

**Important**
The first capturing group of your RegExp needs to contain the dependency path.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String), ([RegExp](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp) \| [DependencyResolver](#dependencyresolver))>

## RenameObject

An object which defines renaming rules.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `from` **([RegExp](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp) \| [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String))** A pattern to match.
-   `to` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** A string to replace matched value.

## PathObject

An object which define a path.

Type: [Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)

**Properties**

-   `path.basename` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the file without it's extension.
-   `path.dirname` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The directory path of the file.
-   `path.extname` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The file extension (including the dot).

## PropsList

A single property or list of properties to sync between cached an new files,
representing either one single property or a complete property path, like:

```js
var obj = {
 foo: 1,
 bar: 2,
 snafu: {
   foo: 3,
   baz: 4
 }
}

'foo'  // single property -> obj.foo
['foo', 'bar']   // property list -> obj.foo, obj.bar
[['snafu', 'foo']]   // property path -> obj.snafu.foo
```

Type: ([string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;([string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>)>)
